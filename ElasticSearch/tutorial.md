이곳에서는 [elastic](https://www.elastic.co/kr)에서 안내하는 **Elasticsearch 시작하기** 내용을 정리합니다.

개인 공부 기록용이지만 도움이 되셨으면 좋겠습니다.

## Elastic Stack?
엘라스틱 스택이란 키바나, 엘라스틱서치, 로그스태쉬 와 같은 프로그램을 함께 일컫는 용어인거 같다. 혹은 이것으로 이루어진 구조를 부르는 듯. 모두 오픈소스 프로젝트이다.

그 외에 추가 적인 기능들은 x-pack이라는 추가제품들로 지원받을 수 있다.
엘라스틱 클라우드는 한달에 45불로 이용하는 클라우드 서비스이다.

여기까진 그냥 광곤데???

여튼...

## Elasticsearch

엘라스틱 스택의 심장이라 불릴정도로 중요한 역할을 한다.

스케일아웃이 가능한 환경 개발자들이 사용하기 편한 API를 지원
풀텍스트 검색지원. 애그리게이션? 을 통해 집계도 가능.
데이터베이스 엔진으로 각광받고 있다.
아파치 2 라이선스 오픈소스이다.
아파치 루신이라고 하는 검색엔진 라이브러리를 사용한다.

### Apache Lucene
자바로 만들어진 검색라이브러리. 대표적으로 아파치 솔라와 엘라스틱 서치가 있다.

엘라스틱은 기본적으로 **클러스터**를 이용한다..?
엘라스틱서치는 데이터를 Shard단위로 분리해서 저장하는데
샤드란 루신레벨의 검색 스레드이고 엘라스틱서치가 실행된 한 프로세스를 **노드**라고 부른다.

노드를 여러개 실행시키면 한 클러스트로 묶여서 같이 동작한다.
노드가 여러개 생성되면 데이터가 저장된 샤드들이 각노드에 샤드로 분배되어 저장된다.
샤드는 무결성을 위해 리플리카라는 복제본을 만들어 또 저장을 한다
프라이머리 샤드와 리플리카는 같은 내용의 도큐먼트들을 저장한다.
유실된 노드가 생기면 유실된 샤드들을 프라이머리 샤드가 다시금 복제 한다.

검색과정: 클라이언트 검색요청을 받으면
검색명령을 받은 노드가 각각 샤드로 전달을 하게 되고
샤드에서는 클라이언트가보낸 쿼리에 맞는 해당 도큐먼트를 찾아서 리턴한다.

어떤 노드가 검색요청을 받아도
마지막 리턴은 샤드레벨로 도큐먼트를 리턴해준다. 머 여튼 같은 결과를 리턴한다.

엘라스틱은 도큐먼트 기반 검색엔진이다. 기본적으로 JSON 도큐먼트를 사용한다.
레스트API 를 제공한다.

호스트:포트/인덱스/타입/도큐먼트아이디

풀텍스트 검색엔진
텍스트 문서들을 검색에 가능하게 가공을해서 역인덱싱을 한다.
검색에 있어서 대소문자 구분이라던지 원어로 검색하는 기능 등을 가지고 있음.

실시간 검색엔진이라 데이터가 저장될 때마다 저장됨과 동시에 색인구조를 만들기 때문에
실시간으로 검색이나 쿼리가 가능하다. 이건 모두가 그렇지 않나?

검색과 어그리게이션을 지원하기때문에 분석/집계가 가능하다.
통계를 낸다던지 그룹단위로 별도의 통계를 본다던지 집계가 가능하다.

자바를 사용하고 자바 힙메모리를 JVMoption파일에서 설정할 수 있다.

여러개의 노드를 실행시킬 수 있으며 이는 루트 폴더를 복제해서 bin/elasticsearch
하면된다.
`nano config/elasticsearch.yml`로 클러스트 이름과 노드이름을 수정할 수 있고
`bin/elasticsearch -E cluster.name=myCluster -E node.name=myNode`로 컨피그 파일을 수정하지 않아도 실행할 때 클러스트와 노드를 설정해줄 수 있다.
이를 통해 같은 클러스트 네임을 가지면 미리 실행되는 마스터 노드를 찾아 바인딩이 되고 두번째 엘라스틱서치 서버는 9201번포트에서 실행된다.


### 스톱!
여기서부터는 내용을 받아적는게 의미 없다는 생각이 들었다. 이거는 써보고 다시 들어봐야 제대로 각인이 될듯..